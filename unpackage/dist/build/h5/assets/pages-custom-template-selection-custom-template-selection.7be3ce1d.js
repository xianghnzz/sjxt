import{r as e,t,aa as a,o as r,c as l,w as i,u as o,e as s,a as d,b as c,d as n,l as u,m as p,F as _,v as f,p as m,s as h,h as y,i as g,g as x,$ as v,I as w,j as b,_ as I,q as j}from"./index-855f89f9.js";import{_ as k}from"./no-data.bcb4c8a9.js";import{a as S,o as M,r as q}from"./uni-app.es.8f4863ce.js";import{_ as C}from"./tui-bottom-popup.df21a1c1.js";import{_ as P}from"./back_bai.3f7a0c49.js";import{_ as L}from"./ss.f111cf75.js";import{_ as F}from"./zs.1adaedfe.js";import{_ as E}from"./close.041a1bd8.js";import{_ as A}from"./_plugin-vue_export-helper.1b428a4d.js";const O=A({__name:"custom-template-selection",setup(A){const O=e({triggered:!1,stylesAllList:[],activeStyle:{},queryInfo:{product_styles_id:"",product_type:1,product_width:"",product_height:"",product_name:""},list:[],activeProduct:{},popupShow:0,materialQueryInfo:{material_name:"",ids:[]},materialList:[],activeMaterial:{}}),{triggered:R,stylesAllList:V,activeStyle:B,queryInfo:U,list:z,activeProduct:D,popupShow:J,materialQueryInfo:N,materialList:Q,activeMaterial:T}=t(O),H=a((()=>h.state.orderFrom));a((()=>h.state.userInfo));const $=()=>{Z()},Z=()=>{s.getMaterialByIds(O.materialQueryInfo).then((e=>{console.log("res",e),O.materialList=e.data,O.popupShow=1}))},G=()=>{var e;let t={};(null==(e=O.activeMaterial)?void 0:e.material_id)>0?(console.log("选择了材质"),t={order_material_id:O.activeMaterial.material_id,order_material_name:O.activeMaterial.material_name,order_material_info:JSON.stringify(O.activeMaterial),order_material_info_obj:O.activeMaterial}):O.materialList.length>0&&(O.activeMaterial=O.materialList[0],t={order_material_id:O.activeMaterial.material_id,order_material_name:O.activeMaterial.material_name,order_material_info:JSON.stringify(O.activeMaterial),order_material_info_obj:O.activeMaterial});const a={...t};O.popupShow=0,h.commit("SET_ORDER_FORM",a),n.goToPage("product-preview",`product_id=${O.activeProduct.product_id}`)},K=()=>{O.list=[],Y()},W=()=>{O.triggered=!0,O.list=[],Y()},X=()=>{},Y=()=>{console.log("data.queryInfo: ",O.queryInfo),s.getProductByIds(O.queryInfo).then((e=>{console.log("res",e),O.list=e.data,O.triggered=!1}),(()=>{O.triggered=!1}))};return S((()=>{})),M((()=>{var e,t,a,r,l,i;console.log("orderFrom",H.value),(null==(t=null==(e=H.value)?void 0:e.order_spec_info_obj)?void 0:t.spec_width)&&(O.queryInfo.product_width=null==(r=null==(a=H.value)?void 0:a.order_spec_info_obj)?void 0:r.spec_width,O.queryInfo.product_height=null==(i=null==(l=H.value)?void 0:l.order_spec_info_obj)?void 0:i.spec_height),console.log("data.queryInfo",O.queryInfo),s.getStylesAllList().then((e=>{O.stylesAllList=e.data,O.stylesAllList.length>0?(O.activeStyle=O.stylesAllList[0],console.log("data.activeStyle",O.activeStyle),O.queryInfo.product_styles_id=O.activeStyle.value,console.log("data.queryInfo",O.queryInfo),Y()):Y()}),(()=>{O.triggered=!1}))})),(e,t)=>{const a=y,s=g,S=x,M=v,A=w,H=q(b("no-data"),k),Y=q(b("tui-bottom-popup"),C),ee=q(b("page"),I);return r(),l(ee,{bgColor:"#fff",topColor:"#00AEEF",topHeight:88,refresherEnabled:!0,triggered:o(R),refresherrefresh:W,scrolltolower:X},{navBar:i((()=>[d(S,{class:"text-center flex align-center justify-center",style:{height:"88rpx"}},{default:i((()=>[d(a,{class:"font-36 text-white"},{default:i((()=>[c("模版选择")])),_:1}),d(S,{onClick:t[0]||(t[0]=e=>o(n).goBack()),class:"position-absolute rounded-circle flex align-center justify-center",style:{width:"40rpx",height:"32rpx",left:"32rpx"}},{default:i((()=>[d(s,{style:{width:"40rpx",height:"32rpx"},src:P,mode:""})])),_:1})])),_:1})])),content:i((()=>[d(S,{class:""},{default:i((()=>[d(S,{class:"bg-primary p-2",style:{height:"200rpx"}},{default:i((()=>[d(M,{class:"bg-white rounded-20 px-2","scroll-x":"true",style:{width:"100%",height:"100%"}},{default:i((()=>[d(S,{class:"flex align-center p-2"},{default:i((()=>[(r(!0),u(_,null,p(o(V),((e,t)=>(r(),l(S,{onClick:t=>(e=>{O.activeStyle=e,O.queryInfo.product_styles_id=e.value,K()})(e),key:t,class:"mr-2",style:{width:"90rpx"}},{default:i((()=>[d(S,{class:"rounded-10",style:{width:"90rpx",height:"90rpx"}},{default:i((()=>[d(s,{style:{width:"90rpx"},src:o(n).showImageUrl(e.styles_cover),mode:"widthFix"},null,8,["src"])])),_:2},1024),d(S,{class:"text-ellipsis text-center",style:{width:"90rpx"}},{default:i((()=>[d(a,{class:j(["font-24",o(U).product_styles_id==e.value?"text-primary":"text-color-999 "])},{default:i((()=>[c(f(e.text),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})])),_:1}),d(S,{class:"bg-primary"},{default:i((()=>[d(S,{class:"p-2 rounded-top-20 bg-white"},{default:i((()=>[d(S,{class:"rounded-circle flex align-center px-2",style:{"background-color":"#f5f5f5",height:"64rpx"}},{default:i((()=>[d(A,{modelValue:o(U).product_name,"onUpdate:modelValue":t[1]||(t[1]=e=>o(U).product_name=e),class:"font-26 flex-1",type:"text",placeholder:"输入模版名称搜索","placeholder-style":"color: #ccc"},null,8,["modelValue"]),d(s,{onClick:K,style:{width:"40rpx",height:"40rpx"},src:L,mode:""})])),_:1}),d(S,{class:"py-2 flex align-center"},{default:i((()=>[d(s,{style:{width:"26rpx",height:"16rpx"},src:F,mode:""}),d(a,{class:"ml-2 font-32"},{default:i((()=>[c(f(o(B).text),1)])),_:1})])),_:1})])),_:1}),d(S,{class:"p-2 flex flex-wrap bg-white"},{default:i((()=>[(r(!0),u(_,null,p(o(z),((e,t)=>(r(),l(S,{onClick:t=>(e=>{O.activeProduct=e;const t={product_id:O.activeProduct.product_id,product_name:O.activeProduct.product_name,product_print:O.activeProduct.product_print,product_type:O.activeProduct.product_type,product_width:O.activeProduct.product_width,product_height:O.activeProduct.product_height},a={order_product_id:t.product_id,order_product_name:t.product_name,order_product_info:JSON.stringify(t),order_product_info_obj:t};h.commit("SET_ORDER_FORM",a),Z()})(e),key:t,class:"m-2"},{default:i((()=>[d(S,{class:j(["rounded-20 overflow-hidden flex align-center justify-center border",o(D).product_id==e.product_id?"border-primary":""]),style:{width:"310rpx",height:"310rpx"}},{default:i((()=>[d(s,{style:{width:"310rpx"},src:o(n).showImageUrl(e.product_cover),mode:"widthFix"},null,8,["src"])])),_:2},1032,["class"]),d(S,{class:"text-ellipsis text-center mt-1",style:{width:"310rpx"}},{default:i((()=>[d(a,{class:j([o(D).product_id==e.product_id?"text-primary":"","font-32"])},{default:i((()=>[c(f(e.product_name),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),d(S,{class:"bg-white py-2"},{default:i((()=>[0==o(z).length?(r(),l(H,{key:0})):m("",!0)])),_:1})])),_:1})])),_:1}),d(Y,{isFixed:"",zIndex:1002,maskZIndex:1001,show:1==o(J)},{default:i((()=>[d(S,{class:"py-3 px-3 flex align-center justify-between"},{default:i((()=>[d(a,{class:"font-32"},{default:i((()=>[c("选择纸张")])),_:1}),d(s,{onClick:t[2]||(t[2]=e=>J.value=0),style:{width:"40rpx",height:"40rpx"},src:E,mode:""})])),_:1}),d(S,{class:"px-2 bg-white flex align-center",style:{height:"80rpx"}},{default:i((()=>[d(S,{class:"rounded-circle flex align-center px-2 flex-1",style:{"background-color":"#f5f5f5",height:"64rpx"}},{default:i((()=>[d(A,{modelValue:o(N).material_name,"onUpdate:modelValue":t[3]||(t[3]=e=>o(N).material_name=e),class:"font-26 flex-1",type:"text",placeholder:"输入纸张名称搜索","placeholder-style":"color: #ccc"},null,8,["modelValue"]),d(s,{onClick:$,style:{width:"40rpx",height:"40rpx"},src:L,mode:""})])),_:1})])),_:1}),d(S,{class:"flex flex-wrap"},{default:i((()=>[(r(!0),u(_,null,p(o(Q),((e,t)=>(r(),l(S,{onClick:t=>(e=>{O.activeMaterial={material_cover:e.material_cover,material_id:e.material_id,material_name:e.material_name}})(e),key:t,class:"m-2"},{default:i((()=>[d(S,{class:j(["rounded-20 overflow-hidden flex align-center justify-center border",o(T).material_id==e.material_id?"border-primary":""]),style:{width:"208rpx",height:"208rpx"}},{default:i((()=>[d(s,{style:{width:"248rpx"},src:o(n).showImageUrl(e.material_cover),mode:"widthFix"},null,8,["src"])])),_:2},1032,["class"]),d(S,{class:"text-ellipsis text-center mt-1",style:{width:"208rpx"}},{default:i((()=>[d(a,{class:j([o(T).material_id==e.material_id?"text-primary":"","font-32"])},{default:i((()=>[c(f(e.material_name),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),d(S,{class:"pt-2 pb-4 flex align-center justify-center px-2"},{default:i((()=>[d(S,{onClick:G,class:"flex-1 flex align-center justify-center linear-gradient rounded-circle",style:{height:"100rpx"}},{default:i((()=>[d(a,{class:"text-white"},{default:i((()=>[c("确认，下一步")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1},8,["triggered"])}}},[["__scopeId","data-v-f93a1a7e"]]);export{O as default};
